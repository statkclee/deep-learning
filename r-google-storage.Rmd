---
title: "딥러닝"
subtitle: "Google Cloud Storage - `googleCloudStorageR`"
author:
- name: "이광춘"
  affiliation: "[Tidyverse Korea](https://www.facebook.com/groups/tidyverse/)"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: default
    toc: yes
    toc_depth: 2
    toc_float: true
    highlight: tango
    code_folding: show
    number_section: true
    self_contained: true
bibliography: bibliography.bib
csl: biomed-central.csl
urlcolor: blue
linkcolor: blue
editor_options: 
  chunk_output_type: console
---

``` {r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE,
                      comment="", digits = 3, tidy = FALSE, prompt = FALSE, fig.align = 'center')

knitr::opts_knit$set(global.par = TRUE) 
```


# `googleCloudStorageR` [^googleCloudStorageR] {#google-cloud-storage}

[^googleCloudStorageR]: [Mark Edmondson (2021-01-05), `googleCloudStorageR`](https://cran.r-project.org/web/packages/googleCloudStorageR/)

[stackoverflow, "How do you make many files public in Google Cloud Storage?"](https://stackoverflow.com/questions/14371376/how-do-you-make-many-files-public-in-google-cloud-storage)

[`googleCloudStorageR`: Interface with Google Cloud Storage API](https://cran.r-project.org/web/packages/googleCloudStorageR/index.html)를 사용해서 [Google Cloud Storage](https://cloud.google.com/storage/) 서비스를 사용할 수 있다. AWS S3서비스를 사용한 경험이 있다면 유사한 기능을 구글 클라우스 플랫폼에서 제공한다고 보면된다.

우선 로컬 컴퓨터에서 [Google Cloud Storage](https://cloud.google.com/storage/) 서비스에 접근하려면 버킷을 만들고 버킷에 파일을 올려둔다. 버킷명은 `julia_silge`, 버킷에 대한 정보와 버킷에 담긴 객체에 대한 정보는 다음 명령어를 통해 확인할 수 있다.

```{r googleCloudStorageR, eval = FALSE}
library(googleCloudStorageR)
# gcs_setup()

gcs_get_global_bucket()
# [1] "julia_silge"
gcs_get_bucket("julia_silge")
# ==Google Cloud Storage Bucket==
# Bucket:          julia_silge 
# Project Number:  856067206497 
# Location:        ASIA-NORTHEAST3 
# Class:           STANDARD 
# Created:         2021-11-05 05:54:53 
# Updated:         2021-11-05 06:24:40 
# Meta-generation: 3 
# eTag:            CAM= 

gcs_list_objects()
#            name  size             updated
# 1 15_silge.flac 99 Mb 2021-11-05 05:57:51
```

# 접속 권한 설정 {#google-cloud-storage-setting}

`Google Cloud Storage`(GCS)에 버킷을 만들고 이를 로컬 컴퓨터(주인만)에서 접근하려면 특별한 설정이 필요하다.
GCS 버컷에 접근할 수 있도록 열쇠를 제작하여 이를 로컬 컴퓨터에서 정해진 방식으로 접근해야만 버킷에 담긴 데이터에 접근이 가능하게 된다.
`googleCloudStorageR` 팩키지 `gcs_setup()` 함수가 도움이 될 수 있다.

```{r googleCloudStorageR-setup, eval = FALSE}
library(googleCloudStorageR)
gcs_setup()

# i ==Welcome to googleCloudStorageR v0.6.0 setup==
# This wizard will scan your system for setup options and help you with any that are missing. 
# Hit 0 or ESC to cancel. 
# 
# 1: Create and download JSON service account key
# 2: Setup auto-authentication (JSON service account key)
# 3: Setup default bucket
#
#Selection: |
```

결론은 아마도 다음과 같이 되지 않을까 싶다.

`usethis::edit_r_environ()` 명령어로 `.Renviron` 파일에 `Google Cloud Storage`에 접근 권한을 설정한다.

```{r Renviron-setup, eval = FALSE}
# Google Cloud Storage
GCS_AUTH_FILE="c:/docs/gothic-centaur-XXXXX-XXXXX.json"
GCS_DEFAULT_BUCKET=julia_silge
```





