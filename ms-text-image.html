<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>Software Carpentry: xwMOOC 딥러닝</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/>
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->


    <!--
    <div id="google_translate_element"></div><script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({pageLanguage: 'ko', includedLanguages: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
    }
    </script><script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    -->
            
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="http://software-carpentry.org" title="Software Carpentry">
          <img alt="Software Carpentry banner" src="img/software-carpentry-banner.png" />
        </a>
      </div>
      <article>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
                    <a href="index.html"><h1 class="title">xwMOOC 딥러닝</h1></a>
          <h2 class="subtitle">텍스트와 이미지 API</h2>
          <h1 id="azure-text-api-key">API 인증키</h1>
<p>애저를 비롯한 다양한 클라우드 서비스를 사용하는 경우 해당 클라우드 사업자가 발급하는 인증키를 사용하는 방식을 취한다. 텍스트 번역이나 컴퓨터 비전, 이미지 감성분석을 위해서 텍스트와 이미지를 클라우드 서비스 끝점(endpoint)으로 보낼 때 인증키도 함께 보내야 클라우드 서비스 제공자가 무료인지, 유료인지, 어떤 서비스에 가입(subscription)했는지 파악할 수 있다.</p>
<p>이런 경우 클라우드 사업자가 발급하는 <strong>키(key)</strong>를 관리해야 해야될 필요가 있는데 R에서 호출하고자 할 때 R이 설치되어 있는 디렉토리(예를 들어 <code>C:\Program Files\R\R-3.5.0\etc\Rprofile.site</code>) 혹은, 데이터 분석과 개발을 진행하는 해당 디렉토리(예를 들어, D:_vision.Rprofile ) 파일에 인증키 정보를 넣어두고 필요시 호출할 때 사용한다.</p>
<p><img src="fig/azure-r-api-key.png" alt="API KEY관리" width="100%" /></p>
<h1 id="azure-text-api">텍스트 <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h1>
<ul>
<li>Text Analytics API
<ul>
<li>언어 탐지: https://eastasia.api.cognitive.microsoft.com/text/analytics/v2.0/<strong>languages</strong></li>
<li>언어 감성(sentiment): https://eastasia.api.cognitive.microsoft.com/text/analytics/v2.0/<strong>sentiment</strong></li>
<li>핵심 용어(key phrases): https://eastasia.api.cognitive.microsoft.com/text/analytics/v2.0/<strong>keyPhrases</strong></li>
</ul></li>
<li>Translator Text API
<ul>
<li>언어 탐지: https://api.cognitive.microsofttranslator.com/detect?api-version=3.0</li>
<li>텍스트 번역: https://api.cognitive.microsofttranslator.com/translate?api-version=3.0
<ul>
<li><code>&amp;to=en&amp;to=ko</code></li>
</ul></li>
<li>사전(Dictionary): https://api.cognitive.microsofttranslator.com/dictionary/lookup?api-version=3.0
<ul>
<li><code>&amp;to=en&amp;to=ko</code></li>
</ul></li>
<li>사전단어 사용례: https://api.cognitive.microsofttranslator.com/dictionary/examples?api-version=3.0
<ul>
<li><code>&amp;to=en&amp;to=ko</code></li>
</ul></li>
</ul></li>
<li>Computer Vision API
<ul>
<li>컴퓨터 비전: https://eastasia.api.cognitive.microsoft.com/vision/v1.0/analyze</li>
<li>감성분석: https://eastasia.api.cognitive.microsoft.com/face/v1.0/detect</li>
</ul></li>
</ul>
<h2 id="language-detect">Text Analytics - 텍스트 언어 탐지</h2>
<p>언어 탐지를 위해서 다양한 표본 데이터를 준비한다. 중국어, 영어, 프랑스어, 한국어, 베트남어 등이 포함된다.</p>
<p>JSON 형태로 데이터를 넘겨야 언어 탐지 API를 활용할 수 있기 때문에 <code>jsonlite</code> 팩키지 <code>toJSON()</code> 함수를 사용한다.</p>
<p>마지막으로 API 호출결과를 받아와서 이를 후속 분석을 위해서 데이터프레임으로 변환시켜 놓는다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># 0. 환경설정 -----</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(rvest)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">library</span>(httr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">library</span>(glue)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="kw">library</span>(jsonlite)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="kw">library</span>(magick)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="co"># 1. 표본 데이터 -----</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;is this english?&quot;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>       ,<span class="st">&quot;tak er der mere kage&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>       ,<span class="st">&quot;merci beaucoup&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>       ,<span class="st">&quot;guten morgen&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a>       ,<span class="st">&quot;대한민국&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a>       ,<span class="st">&quot;That&#39;s terrible&quot;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a>       ,<span class="st">&quot;R is awesome&quot;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a>       ,<span class="st">&quot;中國&quot;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a>       ,<span class="st">&quot;thống kê học&quot;</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a>text_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text), text)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a>df_list &lt;-<span class="kw">list</span>(<span class="dt">documents =</span> text_df)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a><span class="co"># 2. 언어탐지 API 호출 -----</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a>text_analytics_endpoint &lt;-<span class="st"> &quot;https://eastasia.api.cognitive.microsoft.com/text/analytics/v2.0/languages&quot;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> text_analytics_endpoint,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_analytics_api_key)),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(df_list),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_analytics_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp,  <span class="dt">as=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(text_list)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="co"># 2. 언어탐지 API 호출 -----</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>text_api_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>    <span class="dt">id =</span> <span class="kw">as.integer</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>id),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>    <span class="dt">name =</span> <span class="kw">map_chr</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>detectedLanguages, <span class="st">&quot;name&quot;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>    <span class="dt">iso6391Name =</span> <span class="kw">map_chr</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>detectedLanguages, <span class="st">&quot;iso6391Name&quot;</span>),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>    <span class="dt">score =</span> <span class="kw">map_chr</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>detectedLanguages, <span class="st">&quot;score&quot;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in fromJSON(text_list): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">inner_join</span>(text_df, text_api_df) <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in tbl_vars_dispatch(x): 객체 &#39;text_api_df&#39;를 찾을 수 없습니다
</code></pre>
<h2 id="text-sentiment">Text Analytics - 텍스트 감성</h2>
<p>텍스트 언어탐지와 유사한 방식으로 진행하나 끝점에 <strong>sentiment</strong>를 지정한다. 영어를 포함한 다양한 언어를 섞어 던져보았다. 특정 언어에 대한 감성을 파악하는 것도 좋을 듯 싶다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># 2. 텍스트 감성 요청 API -----</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>text_analytics_endpoint &lt;-<span class="st"> &quot;https://eastasia.api.cognitive.microsoft.com/text/analytics/v2.0/&quot;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>emotion_req_url &lt;-<span class="st"> </span><span class="kw">glue</span>(text_analytics_endpoint, <span class="st">&quot;sentiment&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> emotion_req_url,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_analytics_api_key)),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(df_list),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_analytics_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp,  <span class="dt">as=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(text_list)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>text_emo_api_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>    <span class="dt">id =</span> <span class="kw">as.integer</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>id),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>    <span class="dt">emo_score =</span> <span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>score</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in fromJSON(text_list): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="kw">inner_join</span>(text_df, text_emo_api_df) <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in tbl_vars_dispatch(x): 객체 &#39;text_emo_api_df&#39;를 찾을 수 없습니다
</code></pre>
<h2 id="text-key-phrases">Text Analytics - 텍스트 감성</h2>
<p>텍스트 언어탐지, 감성분석과 유사한 방식으로 진행하나 끝점에 <strong>keyPhrases</strong>를 지정한다. 영어를 포함한 다양한 언어를 섞어 던져보았다. 특정 언어 텍스트에 대한 핵심용어 요약하는 것도 좋을 듯 싶다.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># 1. 데이터 (표본) -----</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Hello world. This is some input text that I love.&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>          ,<span class="st">&quot;Bonjour tout le monde&quot;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>          ,<span class="st">&quot;La carretera estaba atascada. Había mucho tráfico el día de ayer.&quot;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>          ,<span class="st">&quot;구글이 2005년 내놓은 세계 최초의 위성영상지도 구글 어스는 지구촌에 큰 충격을 던졌다.&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>text_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text), text)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>df_list &lt;-<span class="kw">list</span>(<span class="dt">documents =</span> text_df)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a><span class="co"># 2. 텍스트 감성 요청 API -----</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a>text_analytics_endpoint &lt;-<span class="st"> &quot;https://eastasia.api.cognitive.microsoft.com/text/analytics/v2.0/&quot;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a>key_phrases_req_url &lt;-<span class="st"> </span><span class="kw">glue</span>(text_analytics_endpoint, <span class="st">&quot;keyPhrases&quot;</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> key_phrases_req_url,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_analytics_api_key)),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(df_list),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_analytics_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp,  <span class="dt">as=</span><span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(text_list)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>text_kp_api_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>    <span class="dt">id =</span> <span class="kw">as.integer</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>id),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a>    <span class="dt">key_phrases =</span> <span class="kw">map</span>(<span class="kw">fromJSON</span>(text_list)<span class="op">$</span>documents<span class="op">$</span>keyPhrases, paste0, <span class="dt">collapse=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in fromJSON(text_list): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="kw">inner_join</span>(text_df, text_kp_api_df) <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>() </span></code></pre></div>
<pre class="error"><code>Error in tbl_vars_dispatch(x): 객체 &#39;text_kp_api_df&#39;를 찾을 수 없습니다
</code></pre>
<h2 id="translator-text-api">Translator Text API - 언어 탐지</h2>
<p>한국어를 비롯한 총 5개 서로 다른 언어를 식별하기 위해서 <code>Translator Text API</code> 끝점에 던져 언어를 탐지하고 번역이 가능한지 판단한다.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="co"># 1. 데이터 (표본) -----</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Hello world. This is some input text that I love.&quot;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a>          ,<span class="st">&quot;Bonjour tout le monde&quot;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>          ,<span class="st">&quot;La carretera estaba atascada. Había mucho tráfico el día de ayer.&quot;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a>          ,<span class="st">&quot;대한민국... 여우&quot;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>          ,<span class="st">&quot;中共中央总书记&quot;</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a>text_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text), text)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a>df_list &lt;-<span class="kw">list</span>(text_df)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a><span class="co"># 2. 텍스트 번역 요청 API: 데이터프레임 -----</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a>text_translation_endpoint &lt;-<span class="st"> &quot;https://api.cognitive.microsofttranslator.com/detect?api-version=3.0&quot;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> text_translation_endpoint,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_translation_api_key)),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(text_df),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_translation_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co"># 3. 데이터프레임 변환-----</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>text_translated_lang_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>    <span class="dt">language =</span> <span class="kw">map_chr</span>(text_list, <span class="op">~</span>.<span class="op">$</span>language),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>    <span class="dt">score =</span> <span class="kw">map_chr</span>(text_list, <span class="op">~</span>.<span class="op">$</span>score),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a>    <span class="dt">isTranslationSupported =</span> <span class="kw">map_chr</span>(text_list, <span class="op">~</span>.<span class="op">$</span>isTranslationSupported),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>    <span class="dt">isTransliterationSupported =</span> <span class="kw">map_chr</span>(text_list, <span class="op">~</span>.<span class="op">$</span>isTransliterationSupported)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in map_chr(text_list, ~.$language): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="kw">bind_cols</span>(text_df, text_translated_lang_df) <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in dots_values(...): 객체 &#39;text_translated_lang_df&#39;를 찾을 수 없습니다
</code></pre>
<h2 id="translator-text-api-translator">Translator Text API - 영어 → 한국어</h2>
<p>영어문장 5개를 넣고 이를 한국어로 번역하는 작업을 진행해본다. 앞서와 유사하게 텍스트 번역 API 끝점을 지정하고 <code>glue()</code> 함수를 통해 번역방향을 영어에서 한국어로 <code>&amp;to=en&amp;to=ko</code>와 같이 지정하고 번역결과를 취합하여 후속 작업을 위한 데이터프레임으로 변환시킨다.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co"># 1. 데이터 (표본) -----</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Hello world. This is some input text that I love.&quot;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a>          ,<span class="st">&quot;the quick brown fox jumps over the lazy dog&quot;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a>          ,<span class="st">&quot;JFK got my VHS, PC and XLR web quiz&quot;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a>          ,<span class="st">&quot;Pack my box with five dozen liquor jugs.&quot;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a>          ,<span class="st">&quot;Amazingly few discotheques provide jukeboxes&quot;</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>text_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text), text)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true"></a>df_list &lt;-<span class="kw">list</span>(text_df)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true"></a><span class="co"># 2. 텍스트 번역 요청 API -----</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true"></a>text_translation_endpoint &lt;-<span class="st"> &quot;https://api.cognitive.microsofttranslator.com/translate?api-version=3.0&quot;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true"></a>text_translation_req_url &lt;-<span class="st"> </span><span class="kw">glue</span>(text_translation_endpoint, <span class="st">&quot;&amp;to=en&amp;to=ko&quot;</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> text_translation_req_url,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_translation_api_key)),</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(text_df),</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_translation_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(text_list)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a><span class="co"># 3. 번역 -----</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true"></a>translation_list &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length =</span> <span class="kw">length</span>(text_list))</span></code></pre></div>
<pre class="error"><code>Error in vector(&quot;list&quot;, length = length(text_list)): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text_list)) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a>    translation_list[[i]] &lt;-<span class="st">  </span><span class="kw">list</span>(<span class="dt">from=</span>text_list[[i]]<span class="op">$</span>translations[[<span class="dv">1</span>]]<span class="op">$</span>text, <span class="dt">to=</span>text_list[[i]]<span class="op">$</span>translations[[<span class="dv">2</span>]]<span class="op">$</span>text)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a>}</span></code></pre></div>
<pre class="error"><code>Error in eval(expr, envir, enclos): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(translation_list)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a>from_df &lt;-<span class="st"> </span><span class="kw">map</span>(translation_list, <span class="op">~</span>.<span class="op">$</span>from) <span class="op">%&gt;%</span><span class="st"> </span>enframe <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">value=</span><span class="kw">unlist</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">from =</span> value)</span></code></pre></div>
<pre class="error"><code>Error in map(translation_list, ~.$from): 객체 &#39;translation_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>to_df   &lt;-<span class="st"> </span><span class="kw">map</span>(translation_list, <span class="op">~</span>.<span class="op">$</span>to)   <span class="op">%&gt;%</span><span class="st"> </span>enframe <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">value=</span><span class="kw">unlist</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">to =</span> value)</span></code></pre></div>
<pre class="error"><code>Error in map(translation_list, ~.$to): 객체 &#39;translation_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="kw">inner_join</span>(from_df, to_df) <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in inner_join(from_df, to_df): 객체 &#39;from_df&#39;를 찾을 수 없습니다
</code></pre>
<h2 id="translator-text-api-dictionary">Translator Text API - 영한사전</h2>
<p>영어단어 5개를 넣고 이를 한국어로 번역하는 작업을 진행해본다. 앞서와 유사하게 사전 번역 API 끝점을 지정하고 <code>glue()</code> 함수를 통해 번역방향을 영어에서 한국어로 <code>&amp;to=en&amp;to=ko</code>와 같이 지정하고 번역결과를 취합하여 후속 작업을 위한 데이터프레임으로 변환시킨다.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;great&quot;</span>, <span class="st">&quot;bank&quot;</span>, <span class="st">&quot;sky&quot;</span>, <span class="st">&quot;pill&quot;</span>, <span class="st">&quot;medicine&quot;</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a>text_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text), text)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true"></a><span class="co"># 2. 텍스트 번역 요청 API -----</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true"></a>dic_translation_endpoint &lt;-<span class="st"> &quot;https://api.cognitive.microsofttranslator.com/dictionary/lookup?api-version=3.0&quot;</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true"></a>dic_translation_req_url &lt;-<span class="st"> </span><span class="kw">glue</span>(dic_translation_endpoint, <span class="st">&quot;&amp;from=en&amp;to=ko&quot;</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> dic_translation_req_url,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_translation_api_key)),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(text_df),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_translation_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a><span class="co"># 3. 사전 번역 -----</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a>translated_word_list &lt;-<span class="st"> </span><span class="kw">map</span>(text_list, <span class="op">~</span>.<span class="op">$</span>translations)</span></code></pre></div>
<pre class="error"><code>Error in map(text_list, ~.$translations): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a>translated_dic_word_list &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length=</span><span class="kw">nrow</span>(text_df))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(text_df)) {</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true"></a>    translated_dic_word_list[[i]] &lt;-<span class="st"> </span><span class="kw">map</span>(translated_word_list[[i]], <span class="op">~</span>.<span class="op">$</span>normalizedTarget) <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_c</span>(., <span class="dt">collapse =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true"></a>}</span></code></pre></div>
<pre class="error"><code>Error in map(translated_word_list[[i]], ~.$normalizedTarget): 객체 &#39;translated_word_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a>translated_dic_word_list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">enframe</span>(<span class="dt">name=</span><span class="st">&quot;id&quot;</span>, <span class="dt">value=</span><span class="st">&quot;translated&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">translated =</span> <span class="kw">unlist</span>(translated)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">inner_join</span>(text_df) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(id, text, translated) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true"></a><span class="st">    </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error: Can&#39;t subset columns that don&#39;t exist.
[31m✖[39m Column `translated` doesn&#39;t exist.
</code></pre>
<h2 id="translator-text-api-dictionary-example">Translator Text API - 사전 단어 활용 사례</h2>
<p>영어단어를 넣고 이에 대응되는 한국어 단어를 넣으면 해당 사전 단어에 대응되는 활용사례를 받을 수 있다. 앞서와 유사하게 사전 번역 API 끝점을 지정하고 <code>glue()</code> 함수를 통해 번역방향을 영어에서 한국어로 <code>&amp;to=en&amp;to=ko</code>와 같이 지정하고 번역결과를 취합하여 후속 작업을 위한 데이터프레임으로 변환시킨다.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a>text &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pill&quot;</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true"></a>translation &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;약&quot;</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true"></a>text_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(text), text, translation)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true"></a>df_list &lt;-<span class="kw">list</span>(text_df)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true"></a><span class="co"># 2. 텍스트 번역 요청 API -----</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true"></a>dic_exam_translation_endpoint &lt;-<span class="st"> &quot;https://api.cognitive.microsofttranslator.com/dictionary/examples?api-version=3.0&quot;</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true"></a>dic_exam_translation_req_url &lt;-<span class="st"> </span><span class="kw">glue</span>(dic_exam_translation_endpoint, <span class="st">&quot;&amp;from=en&amp;to=ko&quot;</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> dic_exam_translation_req_url,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>text_translation_api_key)),</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">toJSON</span>(text_df),</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;text_translation_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a>text_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(text_list)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true"></a><span class="co"># 3. 번역 -----</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true"></a>dic_exam_list &lt;-<span class="st"> </span><span class="kw">map</span>(text_list, <span class="op">~</span>.<span class="op">$</span>examples)[[<span class="dv">1</span>]]</span></code></pre></div>
<pre class="error"><code>Error in map(text_list, ~.$examples): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a>dic_examples_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a>    <span class="dt">from =</span> <span class="kw">map_chr</span>(text_list, <span class="op">~</span>.<span class="op">$</span>normalizedSource),</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true"></a>    <span class="dt">to   =</span> <span class="kw">map_chr</span>(text_list, <span class="op">~</span>.<span class="op">$</span>normalizedTarget),</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true"></a>    <span class="dt">sourcePrefix =</span> <span class="kw">map_chr</span>(dic_exam_list, <span class="op">~</span>.<span class="op">$</span>sourcePrefix),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true"></a>    <span class="dt">sourceTerm   =</span> <span class="kw">map_chr</span>(dic_exam_list, <span class="op">~</span>.<span class="op">$</span>sourceTerm),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true"></a>    <span class="dt">sourceSuffix =</span> <span class="kw">map_chr</span>(dic_exam_list, <span class="op">~</span>.<span class="op">$</span>sourceSuffix),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true"></a>    <span class="dt">targetPrefix =</span> <span class="kw">map_chr</span>(dic_exam_list, <span class="op">~</span>.<span class="op">$</span>targetPrefix),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true"></a>    <span class="dt">targetTerm   =</span> <span class="kw">map_chr</span>(dic_exam_list, <span class="op">~</span>.<span class="op">$</span>targetTerm),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true"></a>    <span class="dt">targetSuffix =</span> <span class="kw">map_chr</span>(dic_exam_list, <span class="op">~</span>.<span class="op">$</span>targetSuffix)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in map_chr(text_list, ~.$normalizedSource): 객체 &#39;text_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a>dic_examples_df &lt;-<span class="st"> </span>dic_examples_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">from_example =</span> <span class="kw">str_c</span>(sourcePrefix, sourceTerm, sourceSuffix),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true"></a>           <span class="dt">to_example   =</span> <span class="kw">str_c</span>(targetPrefix, targetTerm, targetSuffix)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(from, to, from_example, to_example) </span></code></pre></div>
<pre class="error"><code>Error in eval(lhs, parent, parent): 객체 &#39;dic_examples_df&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a>dic_examples_df <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in eval(lhs, parent, parent): 객체 &#39;dic_examples_df&#39;를 찾을 수 없습니다
</code></pre>
<h1 id="azure-image-api">이미지</h1>
<h2 id="azure-image-computer-vision-api">컴퓨터 비전</h2>
<p>컴퓨터 비전 API 문서를 참조해서 정확한 이미지 전달과 이를 통해 꼭 필요한 정보만 받아 올 수 있도록 설정을 하여 API에 호출을 한다.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a><span class="co"># 1. 이미지 데이터 -----</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a>img_url &lt;-<span class="st"> &#39;https://imgur.com/rapIn0u.jpg&#39;</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true"></a><span class="kw">image_read</span>(img_url)</span></code></pre></div>
<p><img src="fig/computer-vision-1.png" title="plot of chunk computer-vision" alt="plot of chunk computer-vision" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="co"># 2. 컴퓨터 비전 API 호출 -----</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true"></a>computer_vision_endpoint &lt;-<span class="st"> &quot;https://eastasia.api.cognitive.microsoft.com/vision/v1.0/analyze&quot;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true"></a>visual_features &lt;-<span class="st"> &quot;Description,Tags,Categories,Faces,Adult&quot;</span> <span class="co"># options = &quot;Categories, Tags, Description, Faces, ImageType, Color, Adult&quot;</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true"></a>details &lt;-<span class="st"> &quot;Landmarks&quot;</span> <span class="co"># options = Landmarks, Celebrities</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true"></a>req_url &lt;-<span class="st"> </span><span class="kw">glue</span>(computer_vision_endpoint, <span class="st">&quot;?visualFeatures=&quot;</span>, visual_features, <span class="st">&quot;&amp;details=&quot;</span>, details)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> req_url,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>computer_vision_api_key)),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true"></a>                 <span class="dt">body=</span><span class="kw">list</span>(<span class="dt">url =</span> img_url),</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>) </span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;computer_vision_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a>img_info_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a>listviewer<span class="op">::</span><span class="kw">jsonedit</span>(img_info_list)</span></code></pre></div>
<pre class="error"><code>Error in list_proper_form(listdata): 객체 &#39;img_info_list&#39;를 찾을 수 없습니다
</code></pre>
<p>이미지에 붙은 태그를 후속 분석을 위해서 데이터프레임으로 변환시킨다.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="co"># 3. 데이터프레임 변환 -----</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a><span class="co">## 3.1. 이미지 태그</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true"></a>img_tag_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true"></a>    <span class="dt">tags_name =</span> <span class="kw">map_chr</span>(img_info_list<span class="op">$</span>tags, <span class="op">~</span>.<span class="op">$</span>name),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true"></a>    <span class="dt">tags_conf =</span> <span class="kw">map_chr</span>(img_info_list<span class="op">$</span>tags, <span class="op">~</span>.<span class="op">$</span>confidence),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true"></a>    <span class="dt">desc_tag =</span> img_info_list<span class="op">$</span>description<span class="op">$</span>tags <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str_c</span>(<span class="dt">collapse=</span><span class="st">&#39;,&#39;</span>)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true"></a>) <span class="op">%&gt;%</span><span class="st"> </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in map_chr(img_info_list$tags, ~.$name): 객체 &#39;img_info_list&#39;를 찾을 수 없습니다
</code></pre>
<p>이미지를 특정하는 정보, 즉 성인물(is_adult), 인종차별(is_racy), 이미지 정보, 캡션 등 정보를 데이터프레임으로 저정한다.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="co">## 3.2. 이미지 정보</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a>img_info_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true"></a>    <span class="dt">is_adult =</span> img_info_list<span class="op">$</span>adult<span class="op">$</span>isAdultContent,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true"></a>    <span class="dt">adult_score =</span>img_info_list<span class="op">$</span>adult<span class="op">$</span>adultScore,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true"></a>    <span class="dt">is_racy =</span> img_info_list<span class="op">$</span>adult<span class="op">$</span>isRacyContent,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true"></a>    <span class="dt">racy_score =</span> img_info_list<span class="op">$</span>adult<span class="op">$</span>racyScore,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true"></a>    <span class="dt">height =</span> img_info_list<span class="op">$</span>metadata<span class="op">$</span>height,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true"></a>    <span class="dt">width =</span> img_info_list<span class="op">$</span>metadata<span class="op">$</span>width,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true"></a>    <span class="dt">format =</span> img_info_list<span class="op">$</span>metadata<span class="op">$</span>format,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true"></a>    <span class="dt">caption =</span> <span class="kw">map_chr</span>(img_info_list<span class="op">$</span>description<span class="op">$</span>captions, <span class="op">~</span>.<span class="op">$</span>text),</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true"></a>    <span class="dt">caption_conf =</span> <span class="kw">map_chr</span>(img_info_list<span class="op">$</span>description<span class="op">$</span>captions, <span class="op">~</span>.<span class="op">$</span>confidence),</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true"></a>    <span class="dt">age =</span> <span class="kw">map_int</span>(img_info_list<span class="op">$</span>faces, <span class="op">~</span>.<span class="op">$</span>age),</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true"></a>    <span class="dt">gender =</span> <span class="kw">map_chr</span>(img_info_list<span class="op">$</span>faces, <span class="op">~</span>.<span class="op">$</span>gender),</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true"></a>    <span class="dt">face_top =</span> <span class="kw">map</span>(img_info_list<span class="op">$</span>faces, <span class="op">~</span>.<span class="op">$</span>faceRectangle)[[<span class="dv">1</span>]]<span class="op">$</span>top,</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true"></a>    <span class="dt">face_left =</span> <span class="kw">map</span>(img_info_list<span class="op">$</span>faces, <span class="op">~</span>.<span class="op">$</span>faceRectangle)[[<span class="dv">1</span>]]<span class="op">$</span>left,</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true"></a>    <span class="dt">face_width =</span> <span class="kw">map</span>(img_info_list<span class="op">$</span>faces, <span class="op">~</span>.<span class="op">$</span>faceRectangle)[[<span class="dv">1</span>]]<span class="op">$</span>width,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true"></a>    <span class="dt">face_height =</span> <span class="kw">map</span>(img_info_list<span class="op">$</span>faces, <span class="op">~</span>.<span class="op">$</span>faceRectangle)[[<span class="dv">1</span>]]<span class="op">$</span>height</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in eval_tidy(xs[[i]], unique_output): 객체 &#39;img_info_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a>img_info_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">gather</span>(metric, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a><span class="st">    </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in eval(lhs, parent, parent): 객체 &#39;img_info_df&#39;를 찾을 수 없습니다
</code></pre>
<p>이미지 인식 중 사람얼굴과 관련된 부분을 뽑아내서 사각형으로 눈,코,입을 포함하는 사각형으로 표식한다.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a><span class="co">## 3.3. 얼굴인식</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a><span class="kw">plot.new</span>()</span></code></pre></div>
<p><img src="fig/computer-vision-face-location-2.png" title="plot of chunk computer-vision-face-location" alt="plot of chunk computer-vision-face-location" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a><span class="kw">image_read</span>(img_url)</span></code></pre></div>
<p><img src="fig/computer-vision-face-location-1.png" title="plot of chunk computer-vision-face-location" alt="plot of chunk computer-vision-face-location" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="kw">rect</span>(img_info_df<span class="op">$</span>face_left, img_info_df<span class="op">$</span>face_top <span class="op">+</span><span class="st"> </span>img_info_df<span class="op">$</span>face_height, img_info_df<span class="op">$</span>face_left <span class="op">+</span><span class="st"> </span>img_info_df<span class="op">$</span>face_width, img_info_df<span class="op">$</span>face_top, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">lwd =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre class="error"><code>Error in rect(img_info_df$face_left, img_info_df$face_top + img_info_df$face_height, : 객체 &#39;img_info_df&#39;를 찾을 수 없습니다
</code></pre>
<h2 id="azure-image-emotion-api">감성분석 <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></h2>
<p>사진에 나타난 감성을 8가지 측면에서 계량화한다. 이를 위해서 이미지를 인터넷에서 가져와서 Face API에 호출하고 결과값을 데이터프레임으로 변환시킨다.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a><span class="co"># 1. 이미지 데이터 -----</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a>img_url &lt;-<span class="st"> &#39;https://i.imgur.com/Rew9eFB.jpg&#39;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a><span class="kw">image_read</span>(img_url)</span></code></pre></div>
<p><img src="fig/computer-vision-emotion-1.png" title="plot of chunk computer-vision-emotion" alt="plot of chunk computer-vision-emotion" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a><span class="co"># 2. 감성 API 호출 -----</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a>face_endpoint &lt;-<span class="st"> &quot;https://eastasia.api.cognitive.microsoft.com/face/v1.0/detect&quot;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true"></a>api_resp &lt;-<span class="st"> </span><span class="kw">POST</span>(<span class="dt">url =</span> face_endpoint,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true"></a>                 <span class="kw">content_type</span>(<span class="st">&#39;application/json&#39;</span>),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true"></a>                 <span class="kw">add_headers</span>(<span class="dt">.headers =</span> <span class="kw">c</span>(<span class="st">&#39;Ocp-Apim-Subscription-Key&#39;</span> =<span class="st"> </span>face_api_key)),</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true"></a>                 <span class="co"># body = &#39;{&quot;url&quot;:&quot;https://i.imgur.com/Rew9eFB.jpg&quot;}&#39;,</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true"></a>                 <span class="dt">body =</span> <span class="kw">list</span>(<span class="dt">url =</span> img_url),</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true"></a>                 <span class="dt">query =</span> <span class="kw">list</span>(<span class="dt">returnFaceAttributes =</span> <span class="st">&quot;emotion,age,gender,hair,makeup,accessories&quot;</span>),</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true"></a>                 <span class="dt">encode =</span> <span class="st">&quot;json&quot;</span>)</span></code></pre></div>
<pre class="error"><code>Error in request(headers = c(..., .headers)): 객체 &#39;face_api_key&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a>img_list &lt;-<span class="st"> </span><span class="kw">content</span>(api_resp)</span></code></pre></div>
<pre class="error"><code>Error in is.response(x): 객체 &#39;api_resp&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a><span class="co"># listviewer::jsonedit(img_list)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true"></a><span class="co"># 3. 데이터프레임 변환 -----</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true"></a>img_face_list &lt;-<span class="st"> </span><span class="kw">map</span>(img_list, <span class="op">~</span>.<span class="op">$</span>faceAttributes)</span></code></pre></div>
<pre class="error"><code>Error in map(img_list, ~.$faceAttributes): 객체 &#39;img_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true"></a><span class="co">## 얼굴 개요</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true"></a><span class="kw">tibble</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true"></a>    <span class="dt">gender =</span> <span class="kw">map_chr</span>(img_face_list, <span class="st">&quot;gender&quot;</span>),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true"></a>    <span class="dt">age =</span> <span class="kw">map_dbl</span>(img_face_list, <span class="st">&quot;age&quot;</span>),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true"></a>    <span class="dt">bald =</span> <span class="kw">map</span>(img_face_list, <span class="op">~</span>.<span class="op">$</span>hair)[[<span class="dv">1</span>]]<span class="op">$</span>bald <span class="op">%&gt;%</span><span class="st"> </span>unlist</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true"></a>)</span></code></pre></div>
<pre class="error"><code>Error in map_chr(img_face_list, &quot;gender&quot;): 객체 &#39;img_face_list&#39;를 찾을 수 없습니다
</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true"></a><span class="co">## 얼굴 감성</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true"></a><span class="kw">map</span>(img_face_list, <span class="op">~</span>.<span class="op">$</span>emotion)[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span>enframe <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">unlist</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true"></a><span class="st">    </span>DT<span class="op">::</span><span class="kw">datatable</span>()</span></code></pre></div>
<pre class="error"><code>Error in map(img_face_list, ~.$emotion): 객체 &#39;img_face_list&#39;를 찾을 수 없습니다
</code></pre>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a href="https://itsalocke.com/blog/r-quick-tip-microsoft-cognitive-services-text-analytics-api/">R QUICK TIP: MICROSOFT COGNITIVE SERVICES’ TEXT ANALYTICS API - March 1, 2017 Steph R</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/translator/">Microsoft Azure - Translator Text API Documentation</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p><a href="https://www.r-bloggers.com/using-microsofts-azure-face-api-to-analyze-videos-in-r/">Using Microsoft’s Azure Face API to analyze videos (in R) December 12, 2017 By Adi Sarid</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
        </div>
      </div>
      </article>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a>
        <a class="label swc-blue-bg" href="https://github.com/swcarpentry/lesson-template">Source</a>
        <a class="label swc-blue-bg" href="mailto:admin@software-carpentry.org">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-37305346-2', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
